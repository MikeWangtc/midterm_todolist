webpackHotUpdate("main",{

/***/ "./src/containers/MainPage/MainPage.js":
/*!*********************************************!*\
  !*** ./src/containers/MainPage/MainPage.js ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/react-router-dom/esm/react-router-dom.js\");\n/* harmony import */ var _assets_css_main_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./assets/css/main.css */ \"./src/containers/MainPage/assets/css/main.css\");\n/* harmony import */ var _assets_css_main_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_assets_css_main_css__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _DashBoard__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DashBoard */ \"./src/containers/MainPage/DashBoard.js\");\n/* harmony import */ var _Map__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Map */ \"./src/containers/MainPage/Map.js\");\n/* harmony import */ var _BriefTable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./BriefTable */ \"./src/containers/MainPage/BriefTable.js\");\n/* harmony import */ var _DetailTable__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./DetailTable */ \"./src/containers/MainPage/DetailTable.js\");\n/* harmony import */ var _TrafficInfoTable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./TrafficInfoTable */ \"./src/containers/MainPage/TrafficInfoTable.js\");\n/* harmony import */ var _models_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./../../models/utils */ \"./src/models/utils.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\n\n\n\n\n\nvar MainPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MainPage, _Component);\n\n  function MainPage(props) {\n    var _this;\n\n    _classCallCheck(this, MainPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MainPage).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleAddTask\", function (task) {\n      var newTask = task;\n      delete newTask['email'];\n\n      _this.setState(function (state) {\n        return {\n          itemList: state.itemList.concat([task])\n        };\n      }, function () {\n        return console.log(_this.state.itemList);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCheckBox\", function (mode, id) {\n      //console.log('revisedItems', this.state.revisedItems);\n      var revisedItems = _this.state.revisedItems; // The task hasn't been revised\n\n      if (revisedItems.filter(function (task) {\n        return task.id === id;\n      }).length === 0) {\n        //console.log('first revision');\n        _this.setState(function (state) {\n          return {\n            revisedItems: state.revisedItems.concat([{\n              id: id,\n              isDone: mode\n            }])\n          };\n        }); //}), () => console.log(`first : ${mode? 'check': 'uncheck'}`,this.state.revisedItems));\n\n      } else {\n        //console.log('has been revised');\n        _this.setState(function (state) {\n          var newList = state.revisedItems.map(function (task) {\n            if (task.id === id) task.isDone = mode;\n            return task;\n          });\n          return {\n            revisedItems: newList\n          };\n        }); //}, () => console.log(`revised : ${mode? 'check': 'uncheck'}`,this.state.revisedItems));\n\n      }\n\n      _this.setState(function (state) {\n        var newItemList = state.itemList.map(function (task) {\n          if (task.id === id) task.isDone = mode;\n          return task;\n        });\n        return {\n          itemList: newItemList\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDeleteTask\", function (event, id) {\n      _this.setState(function (state) {\n        return {\n          discardedItems: state.discardedItems.concat([id])\n        };\n      });\n\n      _this.setState(function (state) {\n        return {\n          itemList: state.itemList.filter(function (task) {\n            return task.id !== id;\n          })\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClearComleted\", function (event) {\n      var itemList = _this.state.itemList;\n      var taskAreDone = itemList.filter(function (task) {\n        return task.isDone;\n      }).map(function (task) {\n        return task.id;\n      });\n\n      if (taskAreDone.length > 0) {\n        _this.setState(function (state) {\n          return {\n            discardedItems: state.discardedItems.concat(taskAreDone)\n          };\n        });\n\n        _this.setState(function (state) {\n          return {\n            itemList: state.itemList.filter(function (task) {\n              return !task.isDone;\n            })\n          };\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleEditTask\", function (event, id) {// TODOS\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFilterDisplayMode\", function (event, mode) {\n      switch (mode) {\n        case 'all':\n          _this.setState({\n            displayMode: 'all'\n          });\n\n          break;\n\n        case 'active':\n          _this.setState({\n            displayMode: 'active'\n          });\n\n          break;\n\n        case 'completed':\n          _this.setState({\n            displayMode: 'completed'\n          });\n\n          break;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTasksDisplayOnMap\", function (mode, id, date, time) {\n      // mode = true => ON, mode = false => OFF\n      if (mode) {\n        _this.setState(function (state) {\n          var newList = state.tasksDisplayOnMap.concat([{\n            id: id,\n            date: date,\n            time: time\n          }]).sort(_models_utils__WEBPACK_IMPORTED_MODULE_8__[\"myCompare\"]);\n          return {\n            tasksDisplayOnMap: newList\n          };\n        });\n      } else {\n        _this.setState(function (state) {\n          return {\n            tasksDisplayOnMap: state.tasksDisplayOnMap.filter(function (elem) {\n              return elem.id !== id;\n            })\n          };\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleLocationUpdate\", function (location, id) {\n      var revisedItems = _this.state.revisedItems;\n\n      if (revisedItems.filter(function (task) {\n        return task.id === id;\n      }).length === 0) {\n        _this.setState(function (state) {\n          return {\n            revisedItems: state.revisedItems.concat([{\n              id: id,\n              location: location\n            }])\n          };\n        }, function () {\n          return console.log('revisedItems', _this.state.revisedItems);\n        }); //}));\n\n      } else {\n        _this.setState(function (state) {\n          var newList = state.revisedItems.map(function (task) {\n            if (task.id === id) task.location = location;\n            return task;\n          });\n          return {\n            revisedItems: newList\n          };\n        }, function () {\n          return console.log('revisedItems', _this.state.revisedItems);\n        }); //});\n\n      }\n\n      _this.setState(function (state) {\n        var newItemList = state.itemList.map(function (task) {\n          if (task.id === id) task.location = location;\n          return task;\n        });\n        return {\n          itemList: newItemList\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTasksTrafficInfo\", function (mode, theTaskID, info) {\n      console.log(_this.state.trafficInfoList);\n\n      if (mode) {\n        _this.setState(function (state) {\n          return {\n            trafficInfoList: state.trafficInfoList.concat([info])\n          };\n        });\n      } else {\n        _this.setState(function (state) {\n          return {\n            trafficInfoList: state.trafficInfoList.filter(function (route) {\n              return route.prevTask.id !== theTaskID && route.theTask.id !== theTaskID;\n            })\n          };\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleLogOut\", function (event) {\n      console.log('discard items:', _this.state.discardedItems);\n      console.log('revised items:', _this.state.revisedItems);\n\n      _this.saveRevisedTasksToDB();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"saveRevisedTasksToDB\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var _this$state, email, discardedItems, revisedItems, body, option;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$state = _this.state, email = _this$state.email, discardedItems = _this$state.discardedItems, revisedItems = _this$state.revisedItems;\n              body = {\n                email: email,\n                discardedItems: discardedItems,\n                revisedItems: revisedItems\n              };\n              option = {\n                method: 'POST',\n                body: JSON.stringify(body),\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json'\n                }\n              };\n              _context.prev = 3;\n              _context.next = 6;\n              return fetch('/logout', option);\n\n            case 6:\n              _context.next = 12;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](3);\n              console.log('failed to save revised tasks to DB');\n              console.log(_context.t0);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 8]]);\n    })));\n\n    _this.state = {\n      itemList: [],\n      // {context, date, time, location, isDone, id}\n      discardedItems: [],\n      // store id\n      revisedItems: [],\n      // store object\n      tasksDisplayOnMap: [],\n      // store {id, date, time} for sorting\n      trafficInfoList: [],\n      // store {task1:{context, address, location}, task2:{...}, info}\n      displayMode: \"all\",\n      email: props.email,\n      userName: props.userName,\n      userLocation: props.userLocation\n    };\n    return _this;\n  }\n\n  _createClass(MainPage, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var option, res, resJSON;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                option = {\n                  method: 'POST',\n                  body: JSON.stringify({\n                    email: this.state.email\n                  }),\n                  headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                  }\n                };\n                _context2.prev = 1;\n                _context2.next = 4;\n                return fetch('/todolist', option);\n\n              case 4:\n                res = _context2.sent;\n                _context2.next = 7;\n                return res.json();\n\n              case 7:\n                resJSON = _context2.sent;\n                this.setState({\n                  itemList: resJSON\n                });\n                _context2.next = 15;\n                break;\n\n              case 11:\n                _context2.prev = 11;\n                _context2.t0 = _context2[\"catch\"](1);\n                console.log('failed to fetch data from DB to render TODOlist');\n                console.log(_context2.t0);\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[1, 11]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var onPageChange = this.props.onPageChange;\n      var _this$state2 = this.state,\n          email = _this$state2.email,\n          userName = _this$state2.userName,\n          userLocation = _this$state2.userLocation,\n          itemList = _this$state2.itemList,\n          displayMode = _this$state2.displayMode,\n          tasksDisplayOnMap = _this$state2.tasksDisplayOnMap,\n          trafficInfoList = _this$state2.trafficInfoList;\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        id: \"wrapper\",\n        style: {\n          display: \"flex\",\n          flexDirection: \"column\",\n          height: \"100%\",\n          overflow: \"scroll\"\n        }\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_DashBoard__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n        email: email,\n        userName: userName,\n        onClick_add: this.handleAddTask,\n        onPageChange: onPageChange,\n        onLogOut: this.handleLogOut\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__[\"Route\"], {\n        path: \"/todolist\",\n        component: function component() {\n          return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"section\", {\n            id: \"one\"\n          }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n            className: \"container\",\n            \"data-position\": \"center\"\n          }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"header\", {\n            className: \"major\"\n          }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"h2\", null, \" TODOS \"))));\n        }\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__[\"Route\"], {\n        path: \"/todolist\",\n        component: function component() {\n          return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_DetailTable__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n            itemList: itemList,\n            displayMode: displayMode,\n            onClick_clear: _this2.handleClearComleted,\n            onClick_check: _this2.handleCheckBox,\n            onClick_delete: _this2.handleDeleteTask,\n            onClick_filter: _this2.handleFilterDisplayMode\n          });\n        }\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__[\"Route\"], {\n        path: \"/taskmap\",\n        component: function component() {\n          return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_BriefTable__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n            activeList: itemList.filter(function (task) {\n              return !task.isDone;\n            }).sort(_models_utils__WEBPACK_IMPORTED_MODULE_8__[\"myCompare\"]),\n            displayList: tasksDisplayOnMap,\n            userLocation: userLocation,\n            onClick_check: _this2.handleTasksDisplayOnMap,\n            updateLocation: _this2.handleLocationUpdate,\n            updateTrafficInfo: _this2.handleTasksTrafficInfo\n          });\n        }\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__[\"Route\"], {\n        path: \"/taskmap/map\",\n        component: function component() {\n          return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Map__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n            position: userLocation,\n            displayList: itemList.filter(function (task) {\n              return tasksDisplayOnMap.filter(function (elem) {\n                return elem.id === task.id;\n              }).length !== 0;\n            })\n          });\n        }\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__[\"Route\"], {\n        path: \"/taskmap/trafficinfo\",\n        component: function component() {\n          return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_TrafficInfoTable__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n            list: trafficInfoList\n          });\n        }\n      })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        id: \"titleBar\"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n        href: \"#header\",\n        className: \"toggle\"\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n        className: \"title\"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n        href: \"#\"\n      }, userName))));\n    }\n  }]);\n\n  return MainPage;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (MainPage);\n\n//# sourceURL=webpack:///./src/containers/MainPage/MainPage.js?");

/***/ })

})